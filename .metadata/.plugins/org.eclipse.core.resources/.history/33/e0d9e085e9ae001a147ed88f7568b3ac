package com.qa.client;

import java.io.IOException;
import java.util.HashMap;

import org.apache.http.Header;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.CloseableHttpResponse;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.CloseableHttpClient;
import org.apache.http.impl.client.HttpClients;
import org.apache.http.util.EntityUtils;
import org.json.JSONObject;

public class RestClient {

	
//1. Lets create one Get method.

	public void getMethod(String URL) throws ClientProtocolException, IOException {
		
		CloseableHttpClient httpClient = HttpClients.createDefault(); // will create one client connection. that is a closable http object
		HttpGet httpget = new HttpGet(URL);
		CloseableHttpResponse CloseableResponse =	httpClient.execute(httpget); // will hit the url.
	
		// We will get the status code from the response
		int Statuscode = CloseableResponse.getStatusLine().getStatusCode();
		System.out.println("The response status code is "+Statuscode);
	
		//We will now get the json String.
		String ResponseString = EntityUtils.toString(CloseableResponse.getEntity(),"UTF-8");
		JSONObject ResponseToJSON = new JSONObject(ResponseString);
		
		System.out.println("Response JSON file from API is "+ ResponseToJSON); 
	
		
		//all headers in 
		Header[] headerArray = CloseableResponse.getAllHeaders();
		HashMap<String, String> allHeaders = new HashMap	<String, String>();
		
		for (Header header:headerArray) {
			
			allHeaders.put(header.getName(),header.getValue());
		}
	
			System.out.println("Header Array" + allHeaders);
	
	
	
	}
	
	
}
